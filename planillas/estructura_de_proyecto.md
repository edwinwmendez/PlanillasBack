# Estructura del Directorio y Contenido de Archivos

## Estructura del Directorio:
│├── planillas/
│    ├── estructura_de_proyecto.md
│    ├── planillas/
│        ├── asgi.py
│        ├── __init__.py
│        ├── settings.py
│        ├── urls.py
│        └── wsgi.py
│    ├── apps/
│        ├── __init__.py
│        └── middleware.py
│        ├── procesos/
│            ├── models.py
│            ├── serializers.py
│            ├── __init__.py
│            ├── apps.py
│            ├── admin.py
│            ├── tests.py
│            ├── urls.py
│            └── views.py
│        ├── reportes/
│            ├── models.py
│            ├── serializers.py
│            ├── __init__.py
│            ├── apps.py
│            ├── admin.py
│            ├── tests.py
│            ├── urls.py
│            └── views.py
│        ├── usuarios/
│            ├── models.py
│            ├── serializers.py
│            ├── __init__.py
│            ├── apps.py
│            ├── admin.py
│            ├── tests.py
│            ├── urls.py
│            └── views.py
│        ├── trabajadores/
│            ├── models.py
│            ├── serializers.py
│            ├── __init__.py
│            ├── apps.py
│            ├── admin.py
│            ├── tests.py
│            ├── urls.py
│            └── views.py
│        ├── autenticacion/
│            ├── models.py
│            ├── serializers.py
│            ├── __init__.py
│            ├── apps.py
│            ├── admin.py
│            ├── tests.py
│            ├── urls.py
│            └── views.py
│        ├── transacciones/
│            ├── models.py
│            ├── serializers.py
│            ├── __init__.py
│            ├── apps.py
│            ├── admin.py
│            ├── tests.py
│            ├── urls.py
│            └── views.py
│        ├── planillas/
│            ├── models.py
│            ├── serializers.py
│            ├── __init__.py
│            ├── apps.py
│            ├── admin.py
│            ├── tests.py
│            ├── urls.py
│            └── views.py
│        ├── auditoria/
│            ├── models.py
│            ├── serializers.py
│            ├── __init__.py
│            ├── apps.py
│            ├── admin.py
│            ├── tests.py
│            ├── urls.py
│            └── views.py


## Contenido de los Archivos:
**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/estructura_de_proyecto.md**
```
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/planillas/asgi.py**
```Python
"""
ASGI config for planillas project.

It exposes the ASGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/5.0/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'planillas.settings')

application = get_asgi_application()
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/planillas/__init__.py**
```Python
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/planillas/settings.py**
```Python
"""
Django settings for planillas project.

Generated by 'django-admin startproject' using Django 5.0.6.

For more information on this file, see
https://docs.djangoproject.com/en/5.0/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/5.0/ref/settings/
"""

from pathlib import Path

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/5.0/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 'django-insecure-q8ttyk@%x5x0p1utw-x3cfvb9xl7bi84&2v9o*3i437r=q)fj0'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'rest_framework',
    'drf_yasg',
    'apps.autenticacion',
    'apps.usuarios',
    'apps.trabajadores',
    'apps.transacciones',
    'apps.planillas',
    'apps.reportes',
    'apps.procesos',
    'apps.auditoria',
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'planillas.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'planillas.wsgi.application'


# Database
# https://docs.djangoproject.com/en/5.0/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}


# Password validation
# https://docs.djangoproject.com/en/5.0/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/5.0/topics/i18n/

LANGUAGE_CODE = 'es-PE'

TIME_ZONE = 'America/Lima'

USE_I18N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/5.0/howto/static-files/

STATIC_URL = 'static/'

# Default primary key field type
# https://docs.djangoproject.com/en/5.0/ref/settings/#default-auto-field

DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'


REST_FRAMEWORK = {
    'DEFAULT_RENDERER_CLASSES': (
        'rest_framework.renderers.JSONRenderer',
    ),
    'DEFAULT_PARSER_CLASSES': (
        'rest_framework.parsers.JSONParser',
    ),
    'DEFAULT_AUTHENTICATION_CLASSES': (
        'rest_framework.authentication.SessionAuthentication',
        'rest_framework.authentication.BasicAuthentication',
    ),
    'DEFAULT_PERMISSION_CLASSES': (
        'rest_framework.permissions.IsAuthenticated',
    ),
}
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/planillas/urls.py**
```Python
# planillas/urls.py (o el archivo principal de urls del proyecto)
from django.contrib import admin
from django.urls import path, include, re_path
from rest_framework import permissions
from drf_yasg.views import get_schema_view
from drf_yasg import openapi

schema_view = get_schema_view(
    openapi.Info(
        title="Sistema de Planillas API",
        default_version='v1',
        description="Documentación de la API del Sistema de Planillas",
    ),
    public=True,
    permission_classes=(permissions.AllowAny,),
)

urlpatterns = [
    path('admin/', admin.site.urls),
    path('api/auth/', include('rest_framework.urls')),
    path('api/autenticacion/', include('apps.autenticacion.urls')),
    path('api/usuarios/', include('apps.usuarios.urls')),
    path('api/trabajadores/', include('apps.trabajadores.urls')),
    path('api/transacciones/', include('apps.transacciones.urls')),
    path('api/planillas/', include('apps.planillas.urls')),
    path('api/reportes/', include('apps.reportes.urls')),
    path('api/procesos/', include('apps.procesos.urls')),
    path('api/auditoria/', include('apps.auditoria.urls')),
    path('swagger/', schema_view.with_ui('swagger', cache_timeout=0), name='schema-swagger-ui'),
    path('redoc/', schema_view.with_ui('redoc', cache_timeout=0), name='schema-redoc'),
    re_path(r'^$', schema_view.with_ui('swagger', cache_timeout=0), name='schema-swagger-ui-redirect'),
]
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/planillas/wsgi.py**
```Python
"""
WSGI config for planillas project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/5.0/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'planillas.settings')

application = get_wsgi_application()
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/__init__.py**
```Python
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/middleware.py**
```Python
# apps/middleware.py
from django.http import HttpResponseForbidden

class UgelRestrictionMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        user = request.user
        if user.is_authenticated and user.role != 'admin_sistema':
            if 'ugel' in request.GET and request.GET['ugel'] != str(user.ugel.id):
                return HttpResponseForbidden("No tiene permiso para acceder a esta UGEL.")
        response = self.get_response(request)
        return response
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/procesos/models.py**
```Python
from django.db import models

# Create your models here.
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/procesos/serializers.py**
```Python
# apps/procesos/serializers.py
from rest_framework import serializers

class ProcesarPlanillaSerializer(serializers.Serializer):
    periodo = serializers.CharField(max_length=6)
    tipo_planilla = serializers.IntegerField()
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/procesos/__init__.py**
```Python
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/procesos/apps.py**
```Python
from django.apps import AppConfig


class ProcesosConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'apps.procesos'
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/procesos/admin.py**
```Python
# apps/procesos/admin.py
from django.contrib import admin

# Registrar modelos si es necesario
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/procesos/tests.py**
```Python
from django.test import TestCase

# Create your tests here.
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/procesos/urls.py**
```Python
# apps/procesos/urls.py
from django.urls import path
from .views import ProcesarPlanillaView

urlpatterns = [
    path('procesar-planilla/', ProcesarPlanillaView.as_view(), name='procesar-planilla'),
]
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/procesos/views.py**
```Python
# apps/procesos/views.py
from django.db import models
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from apps.planillas.models import Periodo, TipoPlanilla
from apps.trabajadores.models import Trabajador
from apps.planillas.models import Contrato
from apps.transacciones.models import TransaccionTrabajador
from .serializers import ProcesarPlanillaSerializer

class ProcesarPlanillaView(APIView):
    def post(self, request, *args, **kwargs):
        serializer = ProcesarPlanillaSerializer(data=request.data)
        if serializer.is_valid():
            periodo = serializer.validated_data['periodo']
            tipo_planilla_id = serializer.validated_data['tipo_planilla']

            try:
                periodo_obj = Periodo.objects.get(periodo=periodo)
                tipo_planilla_obj = TipoPlanilla.objects.get(id=tipo_planilla_id)
            except (Periodo.DoesNotExist, TipoPlanilla.DoesNotExist) as e:
                return Response({"error": str(e)}, status=status.HTTP_400_BAD_REQUEST)

            # Filtrar contratos activos (situacion = 'HAB')
            contratos = Contrato.objects.filter(situacion__codigo='HAB')
            for contrato in contratos:
                total_haberes = TransaccionTrabajador.objects.filter(
                    contrato=contrato,
                    transaccion__tipo='HABER',
                    periodo_inicial__lte=periodo,
                    periodo_final__gte=periodo
                ).aggregate(total=models.Sum('monto'))['total'] or 0

                total_descuentos = TransaccionTrabajador.objects.filter(
                    contrato=contrato,
                    transaccion__tipo='DESCUENTO',
                    periodo_inicial__lte=periodo,
                    periodo_final__gte=periodo
                ).aggregate(total=models.Sum('monto'))['total'] or 0

                essalud = total_haberes * 0.09  # Ejemplo de cálculo de ESSALUD

                Contrato.objects.create(
                    total_haberes=total_haberes,
                    total_descuentos=total_descuentos,
                    essalud=essalud,
                    emitio_boleta=0,
                    contrato=contrato,
                    tipo_planilla=tipo_planilla_obj,
                    periodo=periodo_obj,
                    ugel=contrato.trabajador.ugel
                )

            return Response({"message": "Planillas procesadas exitosamente"}, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/reportes/models.py**
```Python
from django.db import models

# Create your models here.
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/reportes/serializers.py**
```Python
# apps/reportes/serializers.py
from rest_framework import serializers
from apps.trabajadores.models import Trabajador
from apps.transacciones.models import TransaccionTrabajador
from apps.planillas.models import PlanillaBeneficiario

class TransaccionTrabajadorSerializer(serializers.ModelSerializer):
    codigo = serializers.CharField(source='transaccion.codigo')
    descripcion = serializers.CharField(source='transaccion.descripcion')

    class Meta:
        model = TransaccionTrabajador
        fields = ['codigo', 'descripcion', 'monto']
        ref_name = 'TransaccionTrabajadorSerializerReportes'

class TrabajadorSerializer(serializers.ModelSerializer):
    transacciones = TransaccionTrabajadorSerializer(many=True, read_only=True)

    class Meta:
        model = Trabajador
        fields = ['id', 'persona', 'estado', 'ugel', 'transacciones']
        ref_name = 'TrabajadorSerializerReportes'


class PlanillaTrabajadorSerializer(serializers.ModelSerializer):
    transacciones = TransaccionTrabajadorSerializer(many=True, source='transacciones')

    class Meta:
        model = Trabajador  # PlanillaTrabajador si es un modelo separado
        fields = ['total_haberes', 'total_descuentos', 'essalud', 'emitio_boleta', 'trabajador', 'tipo_planilla', 'periodo', 'ugel', 'transacciones']
        ref_name = 'PlanillaTrabajadorSerializerReportes'

class PlanillaBeneficiarioSerializer(serializers.ModelSerializer):
    beneficiario = serializers.StringRelatedField()

    class Meta:
        model = PlanillaBeneficiario
        fields = ['id', 'beneficiario', 'monto', 'periodo']
        ref_name = 'PlanillaBeneficiarioSerializerReportes'```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/reportes/__init__.py**
```Python
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/reportes/apps.py**
```Python
from django.apps import AppConfig


class ReportesConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'apps.reportes'
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/reportes/admin.py**
```Python
# apps/reportes/admin.py
from django.contrib import admin
from apps.trabajadores.models import Trabajador
from apps.planillas.models import Contrato
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/reportes/tests.py**
```Python
from django.test import TestCase

# Create your tests here.
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/reportes/urls.py**
```Python
# apps/reportes/urls.py
from rest_framework.routers import DefaultRouter
from .views import (
    ReporteRemuneracionActivosViewSet, ReportePlanillaBeneficiariosViewSet,
    ReporteTrabajadoresPorClasePlanillaViewSet, ReporteTrabajadoresPorFuenteFinanciamientoViewSet,
    ReporteTrabajadoresPorVinculoViewSet
)

router = DefaultRouter()
router.register(r'remuneracion-activos', ReporteRemuneracionActivosViewSet, basename='reporte-remuneracion-activos')
router.register(r'planilla-beneficiarios', ReportePlanillaBeneficiariosViewSet, basename='reporte-planilla-beneficiarios')
router.register(r'trabajadores-clase-planilla', ReporteTrabajadoresPorClasePlanillaViewSet, basename='reporte-trabajadores-clase-planilla')
router.register(r'trabajadores-fuente-financiamiento', ReporteTrabajadoresPorFuenteFinanciamientoViewSet, basename='reporte-trabajadores-fuente-financiamiento')
router.register(r'trabajadores-vinculo', ReporteTrabajadoresPorVinculoViewSet, basename='reporte-trabajadores-vinculo')

urlpatterns = router.urls
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/reportes/views.py**
```Python
# apps/reportes/views.py
from rest_framework import viewsets
from rest_framework.response import Response
from rest_framework.permissions import IsAuthenticated
from .serializers import TrabajadorSerializer, PlanillaBeneficiarioSerializer
from apps.trabajadores.models import Trabajador
from apps.planillas.models import PlanillaBeneficiario, Contrato

class ReporteRemuneracionActivosViewSet(viewsets.ReadOnlyModelViewSet):
    serializer_class = TrabajadorSerializer
    permission_classes = [IsAuthenticated]

    def get_queryset(self):
        if getattr(self, 'swagger_fake_view', False):
            return Trabajador.objects.none()
        return Trabajador.objects.filter(contratos__situacion__codigo='HAB').distinct()

class ReportePlanillaBeneficiariosViewSet(viewsets.ReadOnlyModelViewSet):
    serializer_class = PlanillaBeneficiarioSerializer
    permission_classes = [IsAuthenticated]

    def get_queryset(self):
        if getattr(self, 'swagger_fake_view', False):
            return PlanillaBeneficiario.objects.none()
        return PlanillaBeneficiario.objects.all()

class ReporteTrabajadoresPorClasePlanillaViewSet(viewsets.ReadOnlyModelViewSet):
    serializer_class = TrabajadorSerializer
    permission_classes = [IsAuthenticated]

    def get_queryset(self):
        if getattr(self, 'swagger_fake_view', False):
            return Trabajador.objects.none()
        clase_planilla = self.request.query_params.get('clase_planilla')
        if clase_planilla:
            return Trabajador.objects.filter(contratos__clase_planilla__nombre_clase_planilla=clase_planilla).distinct()
        return Trabajador.objects.none()

class ReporteTrabajadoresPorFuenteFinanciamientoViewSet(viewsets.ReadOnlyModelViewSet):
    serializer_class = TrabajadorSerializer
    permission_classes = [IsAuthenticated]

    def get_queryset(self):
        if getattr(self, 'swagger_fake_view', False):
            return Trabajador.objects.none()
        fuente_financiamiento = self.request.query_params.get('fuente_financiamiento')
        if fuente_financiamiento:
            return Trabajador.objects.filter(contratos__fuente_financiamiento__nombre_fuente_financiamiento=fuente_financiamiento).distinct()
        return Trabajador.objects.none()

class ReporteTrabajadoresPorVinculoViewSet(viewsets.ReadOnlyModelViewSet):
    serializer_class = TrabajadorSerializer
    permission_classes = [IsAuthenticated]

    def get_queryset(self):
        if getattr(self, 'swagger_fake_view', False):
            return Trabajador.objects.none()
        dias_restantes = self.request.query_params.get('dias_restantes')
        if dias_restantes is not None:
            try:
                dias_restantes = int(dias_restantes)
                return Trabajador.objects.filter(contratos__dias_laborados__lte=dias_restantes).distinct()
            except ValueError:
                pass
        return Trabajador.objects.none()
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/usuarios/models.py**
```Python
# apps/usuarios/models.py
from django.db import models
from django.core.exceptions import ValidationError
from django.utils.translation import gettext_lazy as _
from apps.autenticacion.models import User

class TipoDocumento(models.Model):
    codigo = models.CharField(max_length=2, unique=True, verbose_name='Código')
    descripcion = models.CharField(max_length=50, verbose_name='Descripción')

    def __str__(self):
        return self.descripcion

    class Meta:
        db_table = 'tipo_documento'
        ordering = ['descripcion']
        verbose_name = 'Tipo de Documento'
        verbose_name_plural = 'Tipos de Documento'


class Sexo(models.Model):
    codigo = models.CharField(max_length=1, unique=True, verbose_name='Código')
    descripcion = models.CharField(max_length=20, verbose_name='Descripción')

    def __str__(self):
        return self.descripcion

    class Meta:
        db_table = 'sexo'
        ordering = ['descripcion']
        verbose_name = 'Sexo'
        verbose_name_plural = 'Sexos'


class TipoDescuento(models.Model):
    codigo = models.CharField(max_length=2, unique=True, verbose_name='Código')
    descripcion = models.CharField(max_length=20, verbose_name='Descripción')

    def __str__(self):
        return self.descripcion

    class Meta:
        db_table = 'tipo_descuento'
        ordering = ['descripcion']
        verbose_name = 'Tipo de Descuento'
        verbose_name_plural = 'Tipos de Descuento'


class TipoBeneficiario(models.Model):
    codigo = models.CharField(max_length=2, unique=True, verbose_name='Código')
    descripcion = models.CharField(max_length=20, verbose_name='Descripción')

    def __str__(self):
        return self.descripcion

    class Meta:
        db_table = 'tipo_beneficiario'
        ordering = ['descripcion']
        verbose_name = 'Tipo de Beneficiario'
        verbose_name_plural = 'Tipos de Beneficiario'


class Persona(models.Model):
    user = models.OneToOneField(
        User, on_delete=models.CASCADE, null=True, blank=True,
        related_name='persona'
    )
    tipo_documento = models.ForeignKey(TipoDocumento, on_delete=models.CASCADE, verbose_name='Tipo de Documento')
    numero_documento = models.CharField(
        max_length=12, unique=True, db_index=True,
        verbose_name='Número de Documento'
    )
    paterno = models.CharField(
        max_length=45, blank=True, verbose_name='Apellido Paterno')
    materno = models.CharField(
        max_length=45, blank=True, verbose_name='Apellido Materno')
    nombres = models.CharField(
        max_length=45, blank=True, verbose_name='Nombres')
    fecha_nacimiento = models.DateField(
        null=True, blank=True, verbose_name='Fecha de Nacimiento')
    sexo = models.ForeignKey(Sexo, on_delete=models.CASCADE, verbose_name='Sexo')
    direccion = models.CharField(
        max_length=100, blank=True, verbose_name='Dirección')
    email = models.EmailField(max_length=45, blank=True, verbose_name='Email')

    def __str__(self):
        return f'{self.nombres} {self.paterno} {self.materno}'

    def get_full_name(self):
        return f'{self.nombres} {self.paterno} {self.materno}'.strip()

    def clean(self):
        if self.tipo_documento.codigo == 'DNI' and len(self.numero_documento) != 8:
            raise ValidationError(_('El DNI debe tener 8 caracteres.'))
        elif self.tipo_documento.codigo == 'CET' and len(self.numero_documento) != 9:
            raise ValidationError(_('El Carnet de extranjería debe tener 9 caracteres.'))
        elif self.tipo_documento.codigo == 'PAS' and len(self.numero_documento) != 12:
            raise ValidationError(_('El pasaporte debe tener 12 caracteres.'))

    def save(self, *args, **kwargs):
        self.clean()
        super().save(*args, **kwargs)

    class Meta:
        db_table = 'persona'
        ordering = ['paterno', 'materno', 'nombres']
        verbose_name = 'Persona'
        verbose_name_plural = 'Personas'


class Beneficiario(models.Model):
    empleado = models.ForeignKey(
        'trabajadores.Trabajador', on_delete=models.CASCADE, verbose_name='Empleado', related_name='beneficiarios'
    )
    persona = models.ForeignKey(
        Persona, on_delete=models.CASCADE, verbose_name='Persona'
    )
    relacion_trabajador = models.CharField(
        max_length=45, blank=True, verbose_name='Relación del Trabajador'
    )
    documento_descuento = models.CharField(
        max_length=45, blank=True, verbose_name='Documento de Descuento'
    )
    numero_cuenta = models.CharField(
        max_length=20, blank=True, verbose_name='Número de Cuenta'
    )
    tipo_beneficiario = models.ForeignKey(TipoBeneficiario, on_delete=models.CASCADE, default=1, verbose_name='Tipo de Beneficiario')
    tipo_descuento = models.ForeignKey(TipoDescuento, on_delete=models.CASCADE, default=1, verbose_name='Tipo de Descuento')
    descuento_fijo = models.DecimalField(
        max_digits=8, decimal_places=2, null=True, blank=True, verbose_name='Descuento Fijo'
    )
    porcentaje_descuento = models.IntegerField(
        null=True, blank=True, verbose_name='Porcentaje de Descuento'
    )
    fecha_inicio = models.DateField(
        null=True, blank=True, verbose_name='Fecha de Inicio'
    )
    fecha_fin = models.DateField(
        null=True, blank=True, verbose_name='Fecha de Fin'
    )
    estado = models.BooleanField(
        verbose_name='Estado', default=True, null=True, blank=True
    )
    created = models.DateTimeField(auto_now_add=True)
    updated = models.DateTimeField(auto_now=True)
    banco = models.ForeignKey(
        'trabajadores.Banco', on_delete=models.CASCADE, verbose_name='Banco'
    )

    def __str__(self):
        return f'{self.persona.nombres} {self.persona.paterno} {self.persona.materno}'

    class Meta:
        db_table = 'beneficiario'
        ordering = ['id']
        verbose_name = 'Beneficiario'
        verbose_name_plural = 'Beneficiarios'

    def clean(self):
        if self.tipo_descuento.codigo == 'MF' and not self.descuento_fijo:
            raise ValidationError('Debe especificar un monto fijo para el descuento.')
        if self.tipo_descuento.codigo == 'DP' and not self.porcentaje_descuento:
            raise ValidationError('Debe especificar un porcentaje para el descuento.')

    def save(self, *args, **kwargs):
        self.clean()
        super().save(*args, **kwargs)


class Ugel(models.Model):
    nombre_ugel = models.CharField(
        max_length=100, verbose_name='Nombre de Ugel')
    nombre_corto = models.CharField(
        max_length=25, verbose_name='Nombre Corto', null=True, blank=True)

    def __str__(self):
        return self.nombre_corto

    class Meta:
        db_table = 'ugel'
        ordering = ['nombre_ugel']
        verbose_name = 'UGEL'
        verbose_name_plural = 'UGELs'
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/usuarios/serializers.py**
```Python
# apps/usuarios/serializers.py
from rest_framework import serializers
from .models import Persona, Beneficiario, Ugel

class PersonaSerializer(serializers.ModelSerializer):
    class Meta:
        model = Persona
        fields = ['id', 'user', 'tipo_documento', 'numero_documento', 'paterno', 'materno', 'nombres', 'fecha_nacimiento', 'sexo', 'direccion', 'email']

class BeneficiarioSerializer(serializers.ModelSerializer):
    class Meta:
        model = Beneficiario
        fields = ['id', 'empleado', 'persona', 'relacion_trabajador', 'documento_descuento', 'numero_cuenta', 'tipo_beneficiario', 'tipo_descuento', 'descuento_fijo', 'porcentaje_descuento', 'fecha_inicio', 'fecha_fin', 'estado', 'banco', 'created', 'updated']

class UgelSerializer(serializers.ModelSerializer):
    class Meta:
        model = Ugel
        fields = ['id', 'nombre_ugel', 'nombre_corto']
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/usuarios/__init__.py**
```Python
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/usuarios/apps.py**
```Python
from django.apps import AppConfig


class UsuariosConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'apps.usuarios'```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/usuarios/admin.py**
```Python
# apps/usuarios/admin.py
from django.contrib import admin
from .models import Persona, Beneficiario, Ugel

@admin.register(Persona)
class PersonaAdmin(admin.ModelAdmin):
    list_display = ['nombres', 'paterno', 'materno', 'tipo_documento', 'numero_documento', 'email']
    search_fields = ['nombres', 'paterno', 'materno', 'numero_documento']
    list_filter = ['tipo_documento', 'sexo']
    ordering = ['paterno', 'materno', 'nombres']

@admin.register(Beneficiario)
class BeneficiarioAdmin(admin.ModelAdmin):
    list_display = ['persona', 'empleado', 'tipo_beneficiario', 'tipo_descuento', 'descuento_fijo', 'porcentaje_descuento', 'estado']
    search_fields = ['persona__nombres', 'persona__paterno', 'persona__materno', 'empleado__persona__nombres', 'empleado__persona__paterno', 'empleado__persona__materno']
    list_filter = ['tipo_beneficiario', 'tipo_descuento', 'estado']
    ordering = ['persona', 'empleado']

@admin.register(Ugel)
class UgelAdmin(admin.ModelAdmin):
    list_display = ['nombre_ugel', 'nombre_corto']
    search_fields = ['nombre_ugel', 'nombre_corto']
    ordering = ['nombre_ugel']
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/usuarios/tests.py**
```Python
from django.test import TestCase

# Create your tests here.
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/usuarios/urls.py**
```Python
# apps/usuarios/urls.py
from rest_framework.routers import DefaultRouter
from .views import PersonaViewSet, BeneficiarioViewSet, UgelViewSet

router = DefaultRouter()
router.register(r'personas', PersonaViewSet)
router.register(r'beneficiarios', BeneficiarioViewSet)
router.register(r'ugels', UgelViewSet)

urlpatterns = router.urls
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/usuarios/views.py**
```Python
# apps/usuarios/views.py
from rest_framework import viewsets
from rest_framework.permissions import IsAuthenticated
from .models import Persona, Beneficiario, Ugel
from .serializers import PersonaSerializer, BeneficiarioSerializer, UgelSerializer

class PersonaViewSet(viewsets.ModelViewSet):
    queryset = Persona.objects.all()
    serializer_class = PersonaSerializer
    permission_classes = [IsAuthenticated]

class BeneficiarioViewSet(viewsets.ModelViewSet):
    queryset = Beneficiario.objects.all()
    serializer_class = BeneficiarioSerializer
    permission_classes = [IsAuthenticated]

class UgelViewSet(viewsets.ModelViewSet):
    queryset = Ugel.objects.all()
    serializer_class = UgelSerializer
    permission_classes = [IsAuthenticated]
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/trabajadores/models.py**
```Python
# apps/trabajadores/models.py
from django.db import models
from apps.usuarios.models import Persona

class Trabajador(models.Model):
    persona = models.ForeignKey(Persona, on_delete=models.CASCADE, verbose_name='Persona', related_name='empleados')
    tiempo_servicios = models.CharField(max_length=6, blank=True, verbose_name='Tiempo de Servicios')
    regimen_pensionario = models.ForeignKey('trabajadores.RegimenPensionario', on_delete=models.CASCADE, verbose_name='Régimen Pensionario')
    afp = models.ForeignKey('trabajadores.Afp', on_delete=models.CASCADE, verbose_name='AFP')
    cuspp = models.CharField(max_length=12, blank=True, verbose_name='CUSPP')
    fecha_afiliacion = models.DateField(null=True, blank=True, verbose_name='Fecha de Afiliación')
    fecha_devengue = models.DateField(null=True, blank=True, verbose_name='Fecha de Devengue')
    banco = models.ForeignKey('trabajadores.Banco', on_delete=models.CASCADE, verbose_name='Banco')
    numero_cuenta = models.CharField(max_length=45, blank=True, verbose_name='Número de Cuenta')
    ruc = models.CharField(max_length=11, blank=True, verbose_name='RUC')
    estado = models.BooleanField(verbose_name='Estado', default=True, null=True, blank=True)
    created = models.DateTimeField(auto_now_add=True)
    updated = models.DateTimeField(auto_now=True)

    def __str__(self):
        return f'{self.persona.nombres} {self.persona.paterno} {self.persona.materno}'

    class Meta:
        db_table = 'trabajador'
        ordering = ['id']
        verbose_name = 'Trabajador'
        verbose_name_plural = 'Trabajadores'
        indexes = [
            models.Index(fields=['persona'], name='persona_idx'),
        ]

class Cargo(models.Model):
    nombre_cargo = models.CharField(
        max_length=45, verbose_name='Nombre de Cargo')

    def __str__(self):
        return self.nombre_cargo

    class Meta:
        db_table = 'cargo'
        ordering = ['nombre_cargo']
        verbose_name = 'Cargo'
        verbose_name_plural = 'Cargos'


class RegimenLaboral(models.Model):
    nombre_regimen_laboral = models.CharField(
        max_length=45, verbose_name='Nombre de Régimen Laboral')

    def __str__(self):
        return self.nombre_regimen_laboral

    class Meta:
        db_table = 'regimen_laboral'
        ordering = ['nombre_regimen_laboral']
        verbose_name = 'Régimen Laboral'
        verbose_name_plural = 'Regímenes Laborales'


class TipoServidor(models.Model):
    nombre_tipo_servidor = models.CharField(
        max_length=45, verbose_name='Nombre de Tipo de Servidor')

    def __str__(self):
        return self.nombre_tipo_servidor

    class Meta:
        db_table = 'tipo_servidor'
        ordering = ['nombre_tipo_servidor']
        verbose_name = 'Tipo de Servidor'
        verbose_name_plural = 'Tipos de Servidores'


class RegimenPensionario(models.Model):
    nombre_regimen_pensionario = models.CharField(
        max_length=45, verbose_name='Nombre de Régimen Pensionario')

    def __str__(self):
        return self.nombre_regimen_pensionario

    class Meta:
        db_table = 'regimen_pensionario'
        ordering = ['nombre_regimen_pensionario']
        verbose_name = 'Régimen Pensionario'
        verbose_name_plural = 'Regímenes Pensionarios'


class Afp(models.Model):
    nombre_afp = models.CharField(max_length=45, verbose_name='Nombre de AFP')

    def __str__(self):
        return self.nombre_afp

    class Meta:
        db_table = 'afp'
        ordering = ['nombre_afp']
        verbose_name = 'AFP'
        verbose_name_plural = 'AFPs'


class Banco(models.Model):
    nombre_banco = models.CharField(
        max_length=45, verbose_name='Nombre de Banco')

    def __str__(self):
        return self.nombre_banco

    class Meta:
        db_table = 'banco'
        ordering = ['nombre_banco']
        verbose_name = 'Banco'
        verbose_name_plural = 'Bancos'

class Situacion(models.Model):
    nombre = models.CharField(max_length=45, verbose_name='Nombre de Situación')
    abreviatura = models.CharField(max_length=10, verbose_name='Abreviatura')
    codigo = models.CharField(max_length=10, unique=True, verbose_name='Código')
    created = models.DateTimeField(auto_now_add=True)
    updated = models.DateTimeField(auto_now=True)

    def __str__(self):
        return self.nombre

    class Meta:
        db_table = 'situacion'
        ordering = ['nombre']
        verbose_name = 'Situación'
        verbose_name_plural = 'Situaciones'```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/trabajadores/serializers.py**
```Python
# apps/trabajadores/serializers.py
from rest_framework import serializers
from .models import Trabajador, Cargo, RegimenLaboral, TipoServidor, RegimenPensionario, Afp, Banco, Situacion

class TrabajadorSerializer(serializers.ModelSerializer):
    class Meta:
        model = Trabajador
        fields = '__all__'

class CargoSerializer(serializers.ModelSerializer):
    class Meta:
        model = Cargo
        fields = '__all__'

class RegimenLaboralSerializer(serializers.ModelSerializer):
    class Meta:
        model = RegimenLaboral
        fields = '__all__'

class TipoServidorSerializer(serializers.ModelSerializer):
    class Meta:
        model = TipoServidor
        fields = '__all__'

class RegimenPensionarioSerializer(serializers.ModelSerializer):
    class Meta:
        model = RegimenPensionario
        fields = '__all__'

class AFPSerializer(serializers.ModelSerializer):
    class Meta:
        model = Afp
        fields = '__all__'

class BancoSerializer(serializers.ModelSerializer):
    class Meta:
        model = Banco
        fields = '__all__'

class SituacionSerializer(serializers.ModelSerializer):
    class Meta:
        model = Situacion
        fields = '__all__'```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/trabajadores/__init__.py**
```Python
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/trabajadores/apps.py**
```Python
from django.apps import AppConfig


class TrabajadoresConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'apps.trabajadores'
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/trabajadores/admin.py**
```Python
# apps/trabajadores/admin.py
from django.contrib import admin
from .models import Trabajador, Cargo, RegimenLaboral, TipoServidor, RegimenPensionario, Afp, Banco, Situacion

@admin.register(Trabajador)
class TrabajadorAdmin(admin.ModelAdmin):
    list_display = ('persona', 'estado')
    search_fields = ('persona__nombres', 'persona__paterno', 'persona__materno', 'cargo__nombre_cargo')
    list_filter = ('estado',)
    ordering = ('persona__paterno', 'persona__materno', 'persona__nombres')

@admin.register(Cargo)
class CargoAdmin(admin.ModelAdmin):
    list_display = ('nombre_cargo',)
    search_fields = ('nombre_cargo',)
    ordering = ('nombre_cargo',)

@admin.register(RegimenLaboral)
class RegimenLaboralAdmin(admin.ModelAdmin):
    list_display = ('nombre_regimen_laboral',)
    search_fields = ('nombre_regimen_laboral',)
    ordering = ('nombre_regimen_laboral',)

@admin.register(TipoServidor)
class TipoServidorAdmin(admin.ModelAdmin):
    list_display = ('nombre_tipo_servidor',)
    search_fields = ('nombre_tipo_servidor',)
    ordering = ('nombre_tipo_servidor',)

@admin.register(RegimenPensionario)
class RegimenPensionarioAdmin(admin.ModelAdmin):
    list_display = ('nombre_regimen_pensionario',)
    search_fields = ('nombre_regimen_pensionario',)
    ordering = ('nombre_regimen_pensionario',)

@admin.register(Afp)
class AfpAdmin(admin.ModelAdmin):
    list_display = ('nombre_afp',)
    search_fields = ('nombre_afp',)
    ordering = ('nombre_afp',)

@admin.register(Banco)
class BancoAdmin(admin.ModelAdmin):
    list_display = ('nombre_banco',)
    search_fields = ('nombre_banco',)
    ordering = ('nombre_banco',)

@admin.register(Situacion)
class SituacionAdmin(admin.ModelAdmin):
    list_display = ('nombre', 'abreviatura', 'codigo', 'created', 'updated')
    search_fields = ('nombre', 'abreviatura', 'codigo')
    ordering = ('nombre',)```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/trabajadores/tests.py**
```Python
from django.test import TestCase

# Create your tests here.
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/trabajadores/urls.py**
```Python
from rest_framework.routers import DefaultRouter
from .views import (
    TrabajadorViewSet, CargoViewSet, RegimenLaboralViewSet, 
    TipoServidorViewSet, RegimenPensionarioViewSet, AFPViewSet, BancoViewSet, SituacionViewSet
)

router = DefaultRouter()
router.register(r'trabajadores', TrabajadorViewSet)
router.register(r'cargos', CargoViewSet)
router.register(r'regimenes-laborales', RegimenLaboralViewSet)
router.register(r'tipos-servidores', TipoServidorViewSet)
router.register(r'regimenes-pensionarios', RegimenPensionarioViewSet)
router.register(r'afps', AFPViewSet)
router.register(r'bancos', BancoViewSet)
router.register(r'situaciones', SituacionViewSet)

urlpatterns = router.urls
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/trabajadores/views.py**
```Python
from rest_framework import viewsets
from rest_framework.permissions import IsAuthenticated
from .models import Trabajador, Cargo, RegimenLaboral, TipoServidor, RegimenPensionario, Afp, Banco, Situacion
from .serializers import (
    TrabajadorSerializer, CargoSerializer, RegimenLaboralSerializer,
    TipoServidorSerializer, RegimenPensionarioSerializer, AFPSerializer, BancoSerializer, SituacionSerializer
)

class TrabajadorViewSet(viewsets.ModelViewSet):
    queryset = Trabajador.objects.all()
    serializer_class = TrabajadorSerializer
    permission_classes = [IsAuthenticated]

    def get_queryset(self):
        user = self.request.user
        if user.role == 'admin_sistema':
            return Trabajador.objects.all()
        return Trabajador.objects.filter(ugel=user.ugel)

class CargoViewSet(viewsets.ModelViewSet):
    queryset = Cargo.objects.all()
    serializer_class = CargoSerializer
    permission_classes = [IsAuthenticated]

class RegimenLaboralViewSet(viewsets.ModelViewSet):
    queryset = RegimenLaboral.objects.all()
    serializer_class = RegimenLaboralSerializer
    permission_classes = [IsAuthenticated]

class TipoServidorViewSet(viewsets.ModelViewSet):
    queryset = TipoServidor.objects.all()
    serializer_class = TipoServidorSerializer
    permission_classes = [IsAuthenticated]

class RegimenPensionarioViewSet(viewsets.ModelViewSet):
    queryset = RegimenPensionario.objects.all()
    serializer_class = RegimenPensionarioSerializer
    permission_classes = [IsAuthenticated]

class AFPViewSet(viewsets.ModelViewSet):
    queryset = Afp.objects.all()
    serializer_class = AFPSerializer
    permission_classes = [IsAuthenticated]

class BancoViewSet(viewsets.ModelViewSet):
    queryset = Banco.objects.all()
    serializer_class = BancoSerializer
    permission_classes = [IsAuthenticated]

class SituacionViewSet(viewsets.ModelViewSet):
    queryset = Situacion.objects.all()
    serializer_class = SituacionSerializer
    permission_classes = [IsAuthenticated]```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/autenticacion/models.py**
```Python
# apps/autenticacion/models.py
from django.contrib.auth.models import AbstractUser
from django.db import models

class User(AbstractUser):
    ADMINISTRADOR_DEL_SISTEMA = 'admin_sistema'
    ADMINISTRADOR_UGEL = 'admin_ugel'
    TECNICO_DE_PROCESOS = 'tecnico_procesos'
    TECNICO_DE_PLANILLAS = 'tecnico_planillas'
    TRABAJADOR = 'trabajador'

    ROLE_CHOICES = [
        (ADMINISTRADOR_DEL_SISTEMA, 'Administrador del Sistema'),
        (ADMINISTRADOR_UGEL, 'Administrador UGEL'),
        (TECNICO_DE_PROCESOS, 'Técnico de Procesos'),
        (TECNICO_DE_PLANILLAS, 'Técnico de Planillas'),
        (TRABAJADOR, 'Trabajador'),
    ]

    role = models.CharField(
        max_length=20,
        choices=ROLE_CHOICES,
        default=TRABAJADOR,
        verbose_name='Rol'
    )
    ugel = models.ForeignKey('usuarios.Ugel', on_delete=models.CASCADE, null=True, blank=True, verbose_name='UGEL')

    groups = models.ManyToManyField(
        'auth.Group',
        related_name='custom_user_set',
        blank=True,
        help_text='Los grupos a los que pertenece este usuario. Un usuario obtendrá todos los permisos concedidos a cada uno de sus grupos.',
        verbose_name='grupos',
    )
    user_permissions = models.ManyToManyField(
        'auth.Permission',
        related_name='custom_user_set',
        blank=True,
        help_text='Permisos específicos para este usuario.',
        verbose_name='permisos de usuario',
    )
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/autenticacion/serializers.py**
```Python
# apps/autenticacion/serializers.py
from rest_framework import serializers
from .models import User
from apps.usuarios.models import Ugel

class UgelSerializer(serializers.ModelSerializer):
    class Meta:
        model = Ugel
        fields = ['id', 'nombre_ugel', 'nombre_corto']

class UserSerializer(serializers.ModelSerializer):
    ugel = UgelSerializer(read_only=True)

    class Meta:
        model = User
        fields = ['id', 'username', 'email', 'role', 'is_active', 'date_joined', 'ugel']
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/autenticacion/__init__.py**
```Python
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/autenticacion/apps.py**
```Python
from django.apps import AppConfig


class AutenticacionConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'apps.autenticacion'
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/autenticacion/admin.py**
```Python
# apps/autenticacion/admin.py
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin as BaseUserAdmin
from .models import User

@admin.register(User)
class UserAdmin(BaseUserAdmin):
    fieldsets = (
        (None, {'fields': ('username', 'password')}),
        ('Personal info', {'fields': ('first_name', 'last_name', 'email')}),
        ('Permissions', {'fields': ('is_active', 'is_staff', 'is_superuser', 'groups', 'user_permissions')}),
        ('Important dates', {'fields': ('last_login', 'date_joined')}),
        ('Additional info', {'fields': ('role', 'ugel')}),
    )

    add_fieldsets = (
        (None, {
            'classes': ('wide',),
            'fields': ('username', 'password1', 'password2'),
        }),
        ('Personal info', {
            'fields': ('first_name', 'last_name', 'email')
        }),
        ('Permissions', {
            'fields': ('is_active', 'is_staff', 'is_superuser', 'groups', 'user_permissions')
        }),
        ('Additional info', {
            'fields': ('role', 'ugel')
        }),
    )

    list_display = ('username', 'email', 'first_name', 'last_name', 'is_staff', 'role', 'ugel')
    search_fields = ('username', 'first_name', 'last_name', 'email')
    ordering = ('username',)
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/autenticacion/tests.py**
```Python
from django.test import TestCase

# Create your tests here.
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/autenticacion/urls.py**
```Python
# apps/autenticacion/urls.py
from rest_framework.routers import DefaultRouter
from .views import UserViewSet

router = DefaultRouter()
router.register(r'users', UserViewSet)

urlpatterns = router.urls
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/autenticacion/views.py**
```Python
# apps/autenticacion/views.py
from rest_framework import viewsets
from rest_framework.permissions import IsAuthenticated
from .models import User
from .serializers import UserSerializer

class UserViewSet(viewsets.ModelViewSet):
    queryset = User.objects.all()
    serializer_class = UserSerializer
    permission_classes = [IsAuthenticated]
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/transacciones/models.py**
```Python
# apps/transacciones/models.py
from django.core.exceptions import ValidationError
from django.db import models
from django.db.models import Max
from django.utils.translation import gettext_lazy as _
from apps.planillas.models import Contrato

class Transaccion(models.Model):
    TIPO_CHOICES = [
        ('HABER', 'Haber'),
        ('DESCUENTO', 'Descuento')
    ]
    CATEGORIA_CHOICES = [
        ('SUELDO', 'Sueldo'),
        ('BONIFICACION', 'Bonificación'),
        ('DEDUCCION', 'Deducción'),
        ('BENEFICIOS_SOCIALES', 'Beneficios Sociales'),
        ('APORTE', 'Aporte'),
        ('OTRO', 'Otro')
    ]

    tipo = models.CharField(
        max_length=10, choices=TIPO_CHOICES, verbose_name='Tipo', default='HABER'
    )
    categoria = models.CharField(
        max_length=20, choices=CATEGORIA_CHOICES, verbose_name='Categoría'
    )
    codigo = models.CharField(
        max_length=4, unique=True, verbose_name='Código', help_text='Código de Transacción'
    )
    descripcion = models.CharField(
        max_length=45, verbose_name='Descripción'
    )

    def clean(self):
        if self.tipo == 'HABER' and self.categoria not in ['SUELDO', 'BONIFICACION', 'BENEFICIOS_SOCIALES', 'OTRO']:
            raise ValidationError(_('Categoría inválida para tipo Haber.'))
        if self.tipo == 'DESCUENTO' and self.categoria not in ['DEDUCCION', 'APORTE', 'OTRO']:
            raise ValidationError(_('Categoría inválida para tipo Descuento.'))

    def save(self, *args, **kwargs):
        self.clean()
        super().save(*args, **kwargs)

    def __str__(self):
        return self.descripcion

    class Meta:
        db_table = 'transaccion'
        ordering = ['descripcion']
        verbose_name = 'Transacción'
        verbose_name_plural = 'Transacciones'

class TransaccionTrabajador(models.Model):
    contrato = models.ForeignKey(Contrato, on_delete=models.CASCADE, verbose_name='Contrato', related_name='transacciones')
    transaccion = models.ForeignKey(Transaccion, on_delete=models.CASCADE, verbose_name='Transacción')
    monto = models.DecimalField(max_digits=8, decimal_places=2, null=True, blank=True, verbose_name='Monto')
    periodo_inicial = models.CharField(max_length=6, blank=True, verbose_name='Periodo Inicial')
    periodo_final = models.CharField(max_length=6, blank=True, verbose_name='Periodo Final')
    correlativo = models.IntegerField(verbose_name='Correlativo', editable=False, null=True, blank=True)
    estado = models.BooleanField(verbose_name='Estado', default=True)

    def __str__(self):
        return f'{self.correlativo} - {self.contrato} - {self.transaccion.descripcion} - {self.monto}'

    class Meta:
        db_table = 'transacciones_trabajadores'
        verbose_name = 'Transacción del Trabajador'
        verbose_name_plural = 'Transacciones de los Trabajadores'
        ordering = ['transaccion', 'correlativo']

    def save(self, *args, **kwargs):
        if not self.pk:
            ultimo_correlativo = TransaccionTrabajador.objects.filter(transaccion=self.transaccion).aggregate(Max('correlativo'))['correlativo__max']
            self.correlativo = (ultimo_correlativo or 0) + 1
        super().save(*args, **kwargs)
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/transacciones/serializers.py**
```Python
# apps/transacciones/serializers.py
from rest_framework import serializers
from .models import Transaccion, TransaccionTrabajador

class TransaccionSerializer(serializers.ModelSerializer):
    class Meta:
        model = Transaccion
        fields = '__all__'
        ref_name = 'TransaccionSerializerTransacciones'

class TransaccionTrabajadorSerializer(serializers.ModelSerializer):
    class Meta:
        model = TransaccionTrabajador
        fields = '__all__'
        ref_name = 'TransaccionTrabajadorSerializerTransacciones'
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/transacciones/__init__.py**
```Python
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/transacciones/apps.py**
```Python
from django.apps import AppConfig


class TransaccionesConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'apps.transacciones'
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/transacciones/admin.py**
```Python
# apps/transacciones/admin.py
from django.contrib import admin
from .models import Transaccion, TransaccionTrabajador

class TransaccionTrabajadorInline(admin.TabularInline):
    model = TransaccionTrabajador
    extra = 1  # Número de formularios adicionales vacíos que se mostrarán

@admin.register(Transaccion)
class TransaccionAdmin(admin.ModelAdmin):
    list_display = ('codigo', 'descripcion', 'tipo', 'categoria')
    search_fields = ('codigo', 'descripcion', 'tipo', 'categoria')
    list_filter = ('tipo', 'categoria')
    ordering = ('codigo',)

@admin.register(TransaccionTrabajador)
class TransaccionTrabajadorAdmin(admin.ModelAdmin):
    list_display = ('contrato', 'transaccion', 'monto', 'periodo_inicial', 'periodo_final', 'estado')
    search_fields = ('contrato__trabajador__persona__nombres', 'contrato__trabajador__persona__paterno', 'contrato__trabajador__persona__materno', 'transaccion__descripcion')
    list_filter = ('estado', 'transaccion__tipo')
    ordering = ('transaccion', 'correlativo')
    autocomplete_fields = ['contrato', 'transaccion']
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/transacciones/tests.py**
```Python
from django.test import TestCase

# Create your tests here.
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/transacciones/urls.py**
```Python
# apps/transacciones/urls.py
from rest_framework.routers import DefaultRouter
from .views import TransaccionViewSet, TransaccionTrabajadorViewSet

router = DefaultRouter()
router.register(r'transacciones', TransaccionViewSet)
router.register(r'transacciones-trabajadores', TransaccionTrabajadorViewSet)

urlpatterns = router.urls
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/transacciones/views.py**
```Python
# apps/transacciones/views.py
from rest_framework import viewsets
from rest_framework.permissions import IsAuthenticated
from .models import Transaccion, TransaccionTrabajador
from .serializers import TransaccionSerializer, TransaccionTrabajadorSerializer

class TransaccionViewSet(viewsets.ModelViewSet):
    queryset = Transaccion.objects.all()
    serializer_class = TransaccionSerializer
    permission_classes = [IsAuthenticated]

class TransaccionTrabajadorViewSet(viewsets.ModelViewSet):
    queryset = TransaccionTrabajador.objects.all()
    serializer_class = TransaccionTrabajadorSerializer
    permission_classes = [IsAuthenticated]
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/planillas/models.py**
```Python
# apps/planillas/models.py
from django.db import models
from django.core.exceptions import ValidationError
from apps.trabajadores.models import Trabajador, RegimenLaboral, TipoServidor, Situacion, Cargo
from apps.usuarios.models import Beneficiario


class Periodo(models.Model):
    mes = models.CharField(max_length=2, blank=True, verbose_name='Mes')
    anio = models.CharField(max_length=4, blank=True, verbose_name='Año')
    periodo = models.CharField(
        max_length=6, blank=True, verbose_name='Periodo', editable=False)
    es_adicional = models.BooleanField(
        default=False, verbose_name='¿Es adicional?')
    periodo_actual = models.CharField(
        max_length=6, blank=True, verbose_name='Periodo Actual', editable=False, null=True, default=None)

    def __str__(self):
        return f'{self.periodo} - {self.mes}/{self.anio}'

    def clean(self):
        if not self.periodo:
            self.periodo = f'{self.anio}{self.mes}'
        if not self.es_adicional and Periodo.objects.filter(mes=self.mes, anio=self.anio, es_adicional=False).exists():
            raise ValidationError('Ya existe un período principal para este mes y año.')

    def save(self, *args, **kwargs):
        self.clean()
        if not self.periodo:
            self.periodo = f'{self.anio}{self.mes}'

        if not self.es_adicional:
            last_principal_periodo = Periodo.objects.filter(
                es_adicional=False).order_by('-id').first()
            self.periodo_actual = last_principal_periodo.periodo if last_principal_periodo else None

        if not self.es_adicional and Periodo.objects.filter(mes=self.mes, anio=self.anio, es_adicional=False).exists():
            raise ValidationError('Ya existe un período principal para este mes y año.')

        super().save(*args, **kwargs)

    class Meta:
        db_table = 'periodo'
        ordering = ['anio', 'mes']
        verbose_name = 'Período'
        verbose_name_plural = 'Períodos'


class TipoPlanilla(models.Model):
    nombre_tipo_planilla = models.CharField(
        max_length=45, blank=True, verbose_name='Nombre de Tipo de Planilla')
    codigo_tipo_planilla = models.CharField(max_length=2, blank=True, verbose_name='Código de Tipo de Planilla')

    def __str__(self):
        return self.nombre_tipo_planilla

    class Meta:
        db_table = 'tipo_planilla'
        ordering = ['nombre_tipo_planilla']
        verbose_name = 'Tipo de Planilla'
        verbose_name_plural = 'Tipos de Planilla'



class ClasePlanilla(models.Model):
    nombre_clase_planilla = models.CharField(
        max_length=45, blank=True, verbose_name='Nombre de Clase de Planilla')
    codigo_clase_planilla = models.CharField(max_length=2, blank=True, verbose_name='Código de Clase de Planilla')
    tipo_planilla = models.ForeignKey(
        TipoPlanilla, on_delete=models.CASCADE, verbose_name='Tipo de Planilla', null=True, blank=True)

    def __str__(self):
        return self.nombre_clase_planilla

    class Meta:
        db_table = 'clase_planilla'
        ordering = ['nombre_clase_planilla']
        verbose_name = 'Clase de Planilla'
        verbose_name_plural = 'Clases de Planilla'


class FuenteFinanciamiento(models.Model):
    nombre_fuente_financiamiento = models.CharField(
        max_length=45, blank=True, verbose_name='Nombre de Fuente de Financiamiento')
    codigo_fuente_financiamiento = models.CharField(max_length=2, blank=True, verbose_name='Código de Fuente de Financiamiento')

    def __str__(self):
        return self.nombre_fuente_financiamiento

    class Meta:
        db_table = 'fuente_financiamiento'
        ordering = ['nombre_fuente_financiamiento']
        verbose_name = 'Fuente de Financiamiento'
        verbose_name_plural = 'Fuentes de Financiamiento'


class Contrato(models.Model):
    trabajador = models.ForeignKey(Trabajador, on_delete=models.CASCADE, related_name='contratos')
    cargo = models.ForeignKey(Cargo, on_delete=models.CASCADE, verbose_name='Cargo')
    fecha_ingreso = models.DateField(null=True, blank=True, verbose_name='Fecha de Ingreso')
    fecha_cese = models.DateField(null=True, blank=True, verbose_name='Fecha de Cese')
    documento_contrato = models.CharField(max_length=45, blank=True, verbose_name='Documento de Contrato')
    documento_cese = models.CharField(max_length=45, blank=True, verbose_name='Documento de Cese')
    regimen_laboral = models.ForeignKey(RegimenLaboral, on_delete=models.CASCADE, verbose_name='Régimen Laboral')
    tipo_servidor = models.ForeignKey(TipoServidor, on_delete=models.CASCADE, verbose_name='Tipo de Servidor')
    clase_planilla = models.ForeignKey(ClasePlanilla, on_delete=models.CASCADE, verbose_name='Clase de Planilla')
    fuente_financiamiento = models.ForeignKey(FuenteFinanciamiento, on_delete=models.CASCADE, verbose_name='Fuente de Financiamiento')
    dias_laborados = models.IntegerField(null=True, blank=True, verbose_name='Días Laborados', default=30)
    situacion = models.ForeignKey(Situacion, on_delete=models.CASCADE, verbose_name='Situación')
    created = models.DateTimeField(auto_now_add=True)
    updated = models.DateTimeField(auto_now=True)

    def __str__(self):
        return f'{self.trabajador} - {self.cargo} - {self.fecha_ingreso} - {self.fecha_cese}'

    class Meta:
        db_table = 'contrato'
        ordering = ['id']
        verbose_name = 'Contrato del Trabajador'
        verbose_name_plural = 'Contratos de los Trabajadores'


class PlanillaBeneficiario(models.Model):
    beneficiario = models.ForeignKey(Beneficiario, on_delete=models.CASCADE, verbose_name='Beneficiario')
    periodo = models.ForeignKey(Periodo, on_delete=models.CASCADE, verbose_name='Período')
    monto = models.DecimalField(max_digits=8, decimal_places=2, null=True, blank=True, verbose_name='Monto')

    def __str__(self):
        return f'{self.beneficiario.persona.nombres} {self.beneficiario.persona.paterno} {self.beneficiario.persona.materno} - {self.periodo}'

    class Meta:
        db_table = 'planilla_beneficiario'
        ordering = ['id']
        verbose_name = 'Planilla del Beneficiario'
        verbose_name_plural = 'Planillas de los Beneficiarios'```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/planillas/serializers.py**
```Python
# apps/planillas/serializers.py
from rest_framework import serializers
from .models import Periodo, PlanillaBeneficiario, TipoPlanilla, ClasePlanilla, FuenteFinanciamiento, Contrato
from apps.transacciones.models import TransaccionTrabajador

class TransaccionTrabajadorSerializer(serializers.ModelSerializer):
    class Meta:
        model = TransaccionTrabajador
        fields = '__all__'
        extra_kwargs = {
            'contrato': {'required': False, 'allow_null': True},
            'transaccion': {'required': False, 'allow_null': True},
        }
        ref_name = 'TransaccionTrabajadorSerializerPlanillas'

class PeriodoSerializer(serializers.ModelSerializer):
    class Meta:
        model = Periodo
        fields = '__all__'

class PlanillaBeneficiarioSerializer(serializers.ModelSerializer):
    class Meta:
        model = PlanillaBeneficiario
        fields = '__all__'
        ref_name = 'PlanillaBeneficiarioSerializerPlanillas'

class TipoPlanillaSerializer(serializers.ModelSerializer):
    class Meta:
        model = TipoPlanilla
        fields = '__all__'

class ClasePlanillaSerializer(serializers.ModelSerializer):
    class Meta:
        model = ClasePlanilla
        fields = '__all__'

class FuenteFinanciamientoSerializer(serializers.ModelSerializer):
    class Meta:
        model = FuenteFinanciamiento
        fields = '__all__'

class ContratoSerializer(serializers.ModelSerializer):
    transacciones = TransaccionTrabajadorSerializer(many=True, write_only=True, required=False)
    transacciones_detalles = TransaccionTrabajadorSerializer(many=True, read_only=True, source='transacciones')

    class Meta:
        model = Contrato
        fields = '__all__'

    def create(self, validated_data):
        transacciones_data = validated_data.pop('transacciones', [])
        contrato = Contrato.objects.create(**validated_data)
        for transaccion_data in transacciones_data:
            if transaccion_data:  # Verificar que transaccion_data no esté vacío
                TransaccionTrabajador.objects.create(contrato=contrato, **transaccion_data)
        return contrato

    def update(self, instance, validated_data):
        transacciones_data = validated_data.pop('transacciones', [])
        instance = super().update(instance, validated_data)

        if transacciones_data:
            instance.transacciones.all().delete()  # Elimina las transacciones existentes
            for transaccion_data in transacciones_data:
                if transaccion_data:  # Verificar que transaccion_data no esté vacío
                    TransaccionTrabajador.objects.create(contrato=instance, **transaccion_data)
        
        return instance
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/planillas/__init__.py**
```Python
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/planillas/apps.py**
```Python
from django.apps import AppConfig


class PlanillasConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'apps.planillas'
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/planillas/admin.py**
```Python
# apps/planillas/admin.py
from django.contrib import admin
from .models import Periodo, PlanillaBeneficiario, TipoPlanilla, ClasePlanilla, FuenteFinanciamiento, Contrato
from apps.transacciones.admin import TransaccionTrabajadorInline

@admin.register(Periodo)
class PeriodoAdmin(admin.ModelAdmin):
    list_display = ('periodo', 'mes', 'anio', 'es_adicional', 'periodo_actual')
    search_fields = ('mes', 'anio', 'periodo')
    list_filter = ('es_adicional',)
    ordering = ('anio', 'mes')

@admin.register(PlanillaBeneficiario)
class PlanillaBeneficiarioAdmin(admin.ModelAdmin):
    list_display = ('beneficiario', 'periodo', 'monto')
    search_fields = ('beneficiario__persona__nombres', 'beneficiario__persona__paterno', 'beneficiario__persona__materno')
    list_filter = ('periodo',)
    ordering = ('beneficiario', 'periodo')

@admin.register(TipoPlanilla)
class TipoPlanillaAdmin(admin.ModelAdmin):
    list_display = ('nombre_tipo_planilla', 'codigo_tipo_planilla')
    search_fields = ('nombre_tipo_planilla', 'codigo_tipo_planilla')
    ordering = ('nombre_tipo_planilla',)

@admin.register(ClasePlanilla)
class ClasePlanillaAdmin(admin.ModelAdmin):
    list_display = ('nombre_clase_planilla', 'codigo_clase_planilla', 'tipo_planilla')
    search_fields = ('nombre_clase_planilla', 'codigo_clase_planilla')
    list_filter = ('tipo_planilla',)
    ordering = ('nombre_clase_planilla',)

@admin.register(FuenteFinanciamiento)
class FuenteFinanciamientoAdmin(admin.ModelAdmin):
    list_display = ('nombre_fuente_financiamiento',)
    search_fields = ('nombre_fuente_financiamiento',)
    list_filter = ('nombre_fuente_financiamiento',)
    ordering = ('nombre_fuente_financiamiento',)

# apps/trabajadores/admin.py

@admin.register(Contrato)
class ContratoAdmin(admin.ModelAdmin):
    list_display = ('trabajador', 'cargo', 'fecha_ingreso', 'fecha_cese', 'situacion')
    search_fields = ('trabajador__persona__nombres', 'trabajador__persona__paterno', 'trabajador__persona__materno', 'cargo__nombre_cargo')
    list_filter = ('situacion', 'cargo', 'fecha_ingreso', 'fecha_cese')
    ordering = ('trabajador', 'fecha_ingreso')
    inlines = [TransaccionTrabajadorInline]

```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/planillas/tests.py**
```Python
from django.test import TestCase

# Create your tests here.
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/planillas/urls.py**
```Python
# apps/planillas/urls.py
from rest_framework.routers import DefaultRouter
from .views import (
    PeriodoViewSet, PlanillaBeneficiarioViewSet,
    TipoPlanillaViewSet, ClasePlanillaViewSet, FuenteFinanciamientoViewSet, ContratoViewSet
)

router = DefaultRouter()
router.register(r'periodos', PeriodoViewSet)
router.register(r'contratos', ContratoViewSet)
router.register(r'planillas-beneficiarios', PlanillaBeneficiarioViewSet)
router.register(r'tipos-planilla', TipoPlanillaViewSet)
router.register(r'clases-planilla', ClasePlanillaViewSet)
router.register(r'fuentes-financiamiento', FuenteFinanciamientoViewSet)

urlpatterns = router.urls
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/planillas/views.py**
```Python
# apps/planillas/views.py
from rest_framework import viewsets
from rest_framework.permissions import IsAuthenticated
from .models import Periodo, PlanillaBeneficiario, TipoPlanilla, ClasePlanilla, FuenteFinanciamiento, Contrato
from .serializers import PeriodoSerializer, PlanillaBeneficiarioSerializer, TipoPlanillaSerializer, ClasePlanillaSerializer, FuenteFinanciamientoSerializer, ContratoSerializer

class PeriodoViewSet(viewsets.ModelViewSet):
    queryset = Periodo.objects.all()
    serializer_class = PeriodoSerializer
    permission_classes = [IsAuthenticated]

class PlanillaBeneficiarioViewSet(viewsets.ModelViewSet):
    queryset = PlanillaBeneficiario.objects.all()
    serializer_class = PlanillaBeneficiarioSerializer
    permission_classes = [IsAuthenticated]

class TipoPlanillaViewSet(viewsets.ModelViewSet):
    queryset = TipoPlanilla.objects.all()
    serializer_class = TipoPlanillaSerializer
    permission_classes = [IsAuthenticated]

class ClasePlanillaViewSet(viewsets.ModelViewSet):
    queryset = ClasePlanilla.objects.all()
    serializer_class = ClasePlanillaSerializer
    permission_classes = [IsAuthenticated]

class FuenteFinanciamientoViewSet(viewsets.ModelViewSet):
    queryset = FuenteFinanciamiento.objects.all()
    serializer_class = FuenteFinanciamientoSerializer
    permission_classes = [IsAuthenticated]

class ContratoViewSet(viewsets.ModelViewSet):
    queryset = Contrato.objects.all()
    serializer_class = ContratoSerializer
    permission_classes = [IsAuthenticated]

```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/auditoria/models.py**
```Python
# apps/auditoria/models.py
from django.db import models
from apps.usuarios.models import Persona

class Auditoria(models.Model):
    fecha = models.DateTimeField(auto_now_add=True, verbose_name='Fecha')
    descripcion = models.TextField(verbose_name='Descripción')
    persona = models.ForeignKey(
        Persona, on_delete=models.CASCADE, verbose_name='Persona'
    )
    ip_address = models.GenericIPAddressField(
        null=True, blank=True, verbose_name='Dirección IP'
    )
    user_agent = models.CharField(
        max_length=255, null=True, blank=True, verbose_name='User Agent'
    )
    accion = models.CharField(
        max_length=50, verbose_name='Acción'
    )

    class Meta:
        db_table = 'auditoria'
        ordering = ['-fecha']
        verbose_name = 'Auditoría'
        verbose_name_plural = 'Auditorías'
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/auditoria/serializers.py**
```Python
# apps/auditoria/serializers.py
from rest_framework import serializers
from .models import Auditoria

class AuditoriaSerializer(serializers.ModelSerializer):
    class Meta:
        model = Auditoria
        fields = ['id', 'fecha', 'descripcion', 'persona', 'ip_address', 'user_agent', 'accion']
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/auditoria/__init__.py**
```Python
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/auditoria/apps.py**
```Python
from django.apps import AppConfig


class AuditoriaConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'apps.auditoria'
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/auditoria/admin.py**
```Python
# apps/auditoria/admin.py
from django.contrib import admin
from .models import Auditoria

@admin.register(Auditoria)
class AuditoriaAdmin(admin.ModelAdmin):
    list_display = ['fecha', 'descripcion', 'persona', 'ip_address', 'user_agent', 'accion']
    search_fields = ['descripcion', 'persona__nombres', 'persona__paterno', 'persona__materno', 'ip_address', 'accion']
    list_filter = ['fecha', 'accion']
    ordering = ['-fecha']
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/auditoria/tests.py**
```Python
from django.test import TestCase

# Create your tests here.
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/auditoria/urls.py**
```Python
# apps/auditoria/urls.py
from rest_framework.routers import DefaultRouter
from .views import AuditoriaViewSet

router = DefaultRouter()
router.register(r'auditorias', AuditoriaViewSet)

urlpatterns = router.urls
```

**Ruta: /Volumes/Datos/Trabajo/Sistemas/Planilla/backend/planillas/apps/auditoria/views.py**
```Python
# apps/auditoria/views.py
from rest_framework import viewsets
from .models import Auditoria
from .serializers import AuditoriaSerializer

class AuditoriaViewSet(viewsets.ModelViewSet):
    queryset = Auditoria.objects.all()
    serializer_class = AuditoriaSerializer
```

